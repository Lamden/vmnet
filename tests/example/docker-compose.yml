networks:
  vmnet:
    driver: bridge
    ipam:
      config:
      - gateway: 172.28.5.254
        ip-range: 172.28.5.0/24
        subnet: 172.28.0.0/16
services:
  vmnet_client_1:
    build:
      context: ${LOCAL_PATH}/vmnet
      dockerfile: ${DOCKER_DIR}/vmnet_client
    container_name: vmnet_client_1
    environment:
    - HOST_IP=172.28.5.1
    - SLOT_NUM=0
    - VMNET_SERVER=172.28.5.0
    - VMNET_CLIENT=172.28.5.1,172.28.5.2,172.28.5.3,172.28.5.4,172.28.5.5
    - TEST_NAME=vmnet_example
    image: vmnet_client
    networks:
      vmnet:
        ipv4_address: 172.28.5.1
    volumes:
    - source: ${LOCAL_PATH}/vmnet
      target: /app/
      type: bind
  vmnet_client_2:
    build:
      context: ${LOCAL_PATH}/vmnet
      dockerfile: ${DOCKER_DIR}/vmnet_client
    container_name: vmnet_client_2
    environment:
    - HOST_IP=172.28.5.2
    - SLOT_NUM=1
    - VMNET_SERVER=172.28.5.0
    - VMNET_CLIENT=172.28.5.1,172.28.5.2,172.28.5.3,172.28.5.4,172.28.5.5
    - TEST_NAME=vmnet_example
    image: vmnet_client
    networks:
      vmnet:
        ipv4_address: 172.28.5.2
    volumes:
    - source: ${LOCAL_PATH}/vmnet
      target: /app/
      type: bind
  vmnet_client_3:
    build:
      context: ${LOCAL_PATH}/vmnet
      dockerfile: ${DOCKER_DIR}/vmnet_client
    container_name: vmnet_client_3
    environment:
    - HOST_IP=172.28.5.3
    - SLOT_NUM=2
    - VMNET_SERVER=172.28.5.0
    - VMNET_CLIENT=172.28.5.1,172.28.5.2,172.28.5.3,172.28.5.4,172.28.5.5
    - TEST_NAME=vmnet_example
    image: vmnet_client
    networks:
      vmnet:
        ipv4_address: 172.28.5.3
    volumes:
    - source: ${LOCAL_PATH}/vmnet
      target: /app/
      type: bind
  vmnet_client_4:
    build:
      context: ${LOCAL_PATH}/vmnet
      dockerfile: ${DOCKER_DIR}/vmnet_client
    container_name: vmnet_client_4
    environment:
    - HOST_IP=172.28.5.4
    - SLOT_NUM=3
    - VMNET_SERVER=172.28.5.0
    - VMNET_CLIENT=172.28.5.1,172.28.5.2,172.28.5.3,172.28.5.4,172.28.5.5
    - TEST_NAME=vmnet_example
    image: vmnet_client
    networks:
      vmnet:
        ipv4_address: 172.28.5.4
    volumes:
    - source: ${LOCAL_PATH}/vmnet
      target: /app/
      type: bind
  vmnet_client_5:
    build:
      context: ${LOCAL_PATH}/vmnet
      dockerfile: ${DOCKER_DIR}/vmnet_client
    container_name: vmnet_client_5
    environment:
    - HOST_IP=172.28.5.5
    - SLOT_NUM=4
    - VMNET_SERVER=172.28.5.0
    - VMNET_CLIENT=172.28.5.1,172.28.5.2,172.28.5.3,172.28.5.4,172.28.5.5
    - TEST_NAME=vmnet_example
    image: vmnet_client
    networks:
      vmnet:
        ipv4_address: 172.28.5.5
    volumes:
    - source: ${LOCAL_PATH}/vmnet
      target: /app/
      type: bind
  vmnet_server:
    build:
      context: ${LOCAL_PATH}/vmnet
      dockerfile: ${DOCKER_DIR}/vmnet_server
    container_name: vmnet_server
    environment:
    - HOST_IP=172.28.5.0
    - VMNET_SERVER=172.28.5.0
    - VMNET_CLIENT=172.28.5.1,172.28.5.2,172.28.5.3,172.28.5.4,172.28.5.5
    - TEST_NAME=vmnet_example
    image: vmnet_server
    networks:
      vmnet:
        ipv4_address: 172.28.5.0
    volumes:
    - source: ${LOCAL_PATH}/vmnet
      target: /app/
      type: bind
version: '2.3'
